const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.field=t.map(t=>[...t]),this.initialState=t.map(t=>[...t]),this.status="idle",this.score=0}randomCell(){let t=2;for(let e=0;e<1;e++){let i=[Math.floor(4*Math.random()),Math.floor(4*Math.random())];t=Math.floor(100*Math.random())>89?4:2,0===this.field[i[0]][i[1]]?this.field[i[0]][i[1]]=t:e--}}moveLeft(){let t=this.field.map(t=>t.map(t=>t));if("playing"===this.getStatus())for(let t=0;t<=this.field.length-1;t++)for(let e=0;e<this.field.length-1;e++){for(let t=0;t<=this.field.length-1;t++)for(let e=0;e<this.field.length-1;){let i=this.field[t][e],l=this.field[t][e+1];0===i&&l>0?(this.field[t][e]=this.field[t][e+1],this.field[t][e+1]=0,e=0):e++}this.field[t][e]===this.field[t][e+1]&&(this.field[t][e]*=2,this.score+=this.field[t][e],this.field[t][e+1]=0)}let e=this.getState();JSON.stringify(t)!==JSON.stringify(e)&&this.randomCell()}moveRight(){let t=this.field.map(t=>t.map(t=>t));if("playing"===this.getStatus())for(let t=0;t<=this.field.length-1;t++)for(let e=this.field.length-1;e>0;e--){for(let t=0;t<=this.field.length-1;t++)for(let e=this.field.length-1;e>0;){let i=this.field[t][e],l=this.field[t][e-1];0===i&&l>0?(this.field[t][e]=this.field[t][e-1],this.field[t][e-1]=0,e=this.field.length-1):e--}this.field[t][e]===this.field[t][e-1]&&(this.field[t][e]*=2,this.score+=this.field[t][e],this.field[t][e-1]=0)}let e=this.getState();JSON.stringify(t)!==JSON.stringify(e)&&this.randomCell()}moveUp(){let t=this.field.map(t=>t.map(t=>t));if("playing"===this.getStatus())for(let t=0;t<this.field.length;t++)for(let e=0;e<this.field.length-1;e++){for(let t=0;t<this.field.length;t++)for(let e=0;e<this.field.length-1;){let i=this.field[e][t],l=this.field[e+1][t];0===i&&l>0?(this.field[e][t]=this.field[e+1][t],this.field[e+1][t]=0,e=0):e++}this.field[e][t]===this.field[e+1][t]&&(this.field[e][t]*=2,this.score+=this.field[e][t],this.field[e+1][t]=0)}let e=this.getState();JSON.stringify(t)!==JSON.stringify(e)&&this.randomCell()}moveDown(){let t=this.field.map(t=>t.map(t=>t));if("playing"===this.getStatus())for(let t=this.field.length-1;t>=0;t--)for(let e=this.field.length-1;e>0;e--){for(let t=this.field.length-1;t>=0;t--)for(let e=this.field.length-1;e>0;){let i=this.field[e][t],l=this.field[e-1][t];0===i&&l>0?(this.field[e][t]=this.field[e-1][t],this.field[e-1][t]=0,e=this.field.length-1):e--}this.field[e][t]===this.field[e-1][t]&&(this.field[e][t]*=2,this.score+=this.field[e][t],this.field[e-1][t]=0)}let e=this.getState();JSON.stringify(t)!==JSON.stringify(e)&&this.randomCell()}getScore(){return this.score}getState(){return this.field}canMove(){for(let t=0;t<=3;t++)for(let e=0;e<3;e++)if(this.field[t][e]===this.field[t][e+1])return!0;for(let t=0;t<=3;t++)for(let e=0;e<3;e++)if(this.field[e][t]===this.field[e+1][t])return!0;for(let t=0;t<=3;t++)for(let e=0;e<3;e++)if(0===this.field[e][t])return!0}isWin(){for(let t=0;t<this.field.length;t++)for(let e=0;e<this.field.length;e++)if(this.field[t][e]>=2048)return!0}getStatus(){return this.canMove()||(this.status="lose"),this.isWin()&&(this.status="win"),this.status}start(){let t=2;for(let e=0;e<2;e++){let i=[Math.floor(4*Math.random()),Math.floor(4*Math.random())];0===this.field[i[0]][i[1]]?(t=Math.floor(100*Math.random())>89?4:2,this.field[i[0]][i[1]]=t):e--}this.status="playing"}restart(t){this.status="idle",this.score=0,this.field=this.initialState.map(t=>[...t])}},e=document.querySelector(".start"),i=document.querySelector(".game-field"),l=document.querySelector(".message-start"),s=document.querySelector(".game-score"),f=document.querySelector(".message-lose"),h=document.querySelector(".message-win");e.addEventListener("click",()=>{if(e.classList.contains("restart")){e.textContent="Restart",h.classList.add("hidden"),f.classList.add("hidden");for(let e=0;e<4;e++)for(let l=0;l<4;l++)i.rows[e].cells[l].classList.remove(`field-cell--${t.field[e][l]}`),i.rows[e].cells[l].textContent="";t.restart(),s.textContent=t.getScore(),t.start();for(let e=0;e<4;e++)for(let l=0;l<4;l++)0!==t.field[e][l]&&(i.rows[e].cells[l].classList.add(`field-cell--${t.field[e][l]}`),i.rows[e].cells[l].textContent=t.field[e][l])}else{e.classList.add("restart"),e.textContent="Restart",l.classList.add("hidden"),t.start();for(let e=0;e<4;e++)for(let l=0;l<4;l++)0!==t.field[e][l]&&(i.rows[e].cells[l].classList.add(`field-cell--${t.field[e][l]}`),i.rows[e].cells[l].textContent=t.field[e][l])}}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowRight":t.moveRight();break;case"ArrowLeft":t.moveLeft()}!function(){for(let e=0;e<t.field.length;e++)for(let l=0;l<t.field.length;l++)i.rows[e].cells[l].classList.remove(`field-cell--${i.rows[e].cells[l].textContent}`),i.rows[e].cells[l].textContent="",0!==t.field[e][l]&&(i.rows[e].cells[l].textContent=t.field[e][l],i.rows[e].cells[l].classList.add(`field-cell--${t.field[e][l]}`));s.textContent=t.score}()}"win"===t.getStatus()&&h.classList.remove("hidden"),"lose"===t.getStatus()&&f.classList.remove("hidden")});
//# sourceMappingURL=index.e45ed96b.js.map
